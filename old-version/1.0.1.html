<!DOCTYPE html>
<html lang="fr">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Journal de RÃªves</title>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  background-color: #111;
Â  Â  Â  color: #eee;
Â  Â  Â  padding: 2rem;
Â  Â  Â  max-width: 700px;
Â  Â  Â  margin: auto;
Â  Â  }
Â  Â  textarea {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 150px;
Â  Â  Â  padding: 1rem;
Â  Â  Â  background-color: #222;
Â  Â  Â  color: #fff;
Â  Â  Â  border: 1px solid #444;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â  /* Conteneur du textarea et boutons */
Â  Â  .textarea-container {
Â  Â  Â  position: relative;
Â  Â  }
Â  Â  /* Boutons micro et effacer en bas Ã  droite */
Â  Â  #micButton, #clearButton {
Â  Â  Â  position: absolute;
Â  Â  Â  bottom: 12px;
Â  Â  Â  width: 40px;
Â  Â  Â  height: 40px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  cursor: pointer;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  box-shadow: 0 0 8px #4caf50;
Â  Â  Â  background-color: #4caf50;
Â  Â  Â  transition: background-color 0.3s;
Â  Â  }
Â  Â  #micButton.recording {
Â  Â  Â  background-color: #e74c3c;
Â  Â  Â  box-shadow: 0 0 12px #e74c3c;
Â  Â  }
Â  Â  #micButton {
Â  Â  Â  right: 12px;
Â  Â  }
Â  Â  #clearButton {
Â  Â  Â  right: 60px; /* Ã  gauche du micro */
Â  Â  Â  background-color: #666;
Â  Â  Â  box-shadow: 0 0 8px #666;
Â  Â  }
Â  Â  /* Hover pour tous les boutons */
Â  Â  button:hover {
Â  Â  Â  background-color: #888 !important;
Â  Â  Â  box-shadow: 0 0 12px #888 !important;
Â  Â  }
Â  Â  /* On remet le rouge du micro en enregistrement au hover */
Â  Â  #micButton.recording:hover {
Â  Â  Â  background-color: #ff4c4c !important;
Â  Â  Â  box-shadow: 0 0 14px #ff4c4c !important;
Â  Â  }
Â  Â  /* SVG des icÃ´nes */
Â  Â  #micButton svg, #clearButton svg {
Â  Â  Â  fill: white;
Â  Â  Â  width: 20px;
Â  Â  Â  height: 20px;
Â  Â  }
Â  Â  button {
Â  Â  Â  background-color: #4CAF50;
Â  Â  Â  color: white;
Â  Â  Â  padding: 0.6rem 1.2rem;
Â  Â  Â  margin-top: 1rem;
Â  Â  Â  margin-right: 0.5rem;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  ul {
Â  Â  Â  list-style: none;
Â  Â  Â  padding: 0;
Â  Â  }
Â  Â  li {
Â  Â  Â  background-color: #1e1e1e;
Â  Â  Â  padding: 1rem;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  margin-top: 1rem;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â  .date {
Â  Â  Â  font-size: 0.8rem;
Â  Â  Â  color: #aaa;
Â  Â  }
Â  Â  .delete-btn {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 0.5rem;
Â  Â  Â  right: 0.5rem;
Â  Â  Â  background: #e74c3c;
Â  Â  Â  border: none;
Â  Â  Â  color: white;
Â  Â  Â  padding: 0.3rem 0.6rem;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .delete-btn:hover {
Â  Â  Â  background-color: #ff4c4c;
Â  Â  }
Â  </style>
</head>
<body>
Â  <div id="authContainer">
Â  Â  <h2>ğŸ”’ AccÃ¨s sÃ©curisÃ©</h2>
Â  Â  <input type="password" id="passwordInput" placeholder="Mot de passe" />
Â  Â  <button onclick="checkPassword()">Connexion</button>
Â  </div>

Â  <div id="mainApp" style="display: none;">
Â  Â  <h1>ğŸŒ™ Mon Journal de RÃªves</h1>
Â  Â  <div class="textarea-container">
Â  Â  Â  <textarea id="dreamInput" placeholder="Ã‰cris ton rÃªve ici..."></textarea>
Â  Â  Â  <button id="clearButton" title="Effacer tout" aria-label="Effacer tout">
Â  Â  Â  Â  <svg viewBox="0 0 24 24"><path d="M18 6 L6 18 M6 6 L18 18" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
Â  Â  Â  </button>
Â  Â  Â  <button id="micButton" title="DÃ©marrer la dictÃ©e vocale" aria-label="DÃ©marrer la dictÃ©e vocale">
Â  Â  Â  Â  <svg viewBox="0 0 24 24"><path d="M12 14a3 3 0 0 0 3-3V5a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3zM19 10v1a7 7 0 0 1-14 0v-1"/></svg>
Â  Â  Â  </button>
Â  Â  </div>
Â  Â  <label>
Â  Â  Â  <input type="checkbox" id="lucidCheckbox" /> ğŸŒŸ C'Ã©tait un rÃªve lucide
Â  Â  </label><br />
Â  Â  <button onclick="saveDream()">ğŸ’¾ Sauvegarder</button>
Â  Â  <button onclick="exportDreams()">ğŸ“¥ Exporter en fichier texte</button>
Â  Â  <button onclick="confirmDeleteAll()">ğŸ—‘ï¸ Supprimer tous les rÃªves</button>
Â  Â  <h2>Mes RÃªves</h2>
Â  Â  <label for="filterSelect">ğŸ” Filtrer :</label>
Â  Â  <select id="filterSelect" onchange="loadDreams()">
Â  Â  Â  <option value="all">Tous</option>
Â  Â  Â  <option value="lucid">Lucides seulement</option>
Â  Â  Â  <option value="non-lucid">Non lucides</option>
Â  Â  </select>
Â  Â  <ul id="dreamList"></ul>
Â  </div>

Â  <script>
Â  Â  const PASSWORD = "rceavleine1234";
Â  Â Â 
Â  Â  const dreamInput = document.getElementById("dreamInput");
Â  Â  const lucidCheckbox = document.getElementById("lucidCheckbox");
Â  Â  const dreamList = document.getElementById("dreamList");
Â  Â  const filterSelect = document.getElementById("filterSelect");
Â  Â  const micButton = document.getElementById("micButton");
Â  Â  const clearButton = document.getElementById("clearButton");

Â  Â  function checkPassword() {
Â  Â  Â  const input = document.getElementById("passwordInput").value;
Â  Â  Â  if (input === PASSWORD) {
Â  Â  Â  Â  document.getElementById("authContainer").style.display = "none";
Â  Â  Â  Â  document.getElementById("mainApp").style.display = "block";
Â  Â  Â  Â  loadDreams();
Â  Â  Â  } else {
Â  Â  Â  Â  alert("Mot de passe incorrect.");
Â  Â  Â  }
Â  Â  }

Â  Â  // === DictÃ©e vocale ===
Â  Â  let recognition;
Â  Â  let isRecording = false;

Â  Â  function setupRecognition() {
Â  Â  Â  if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
Â  Â  Â  Â  alert("La reconnaissance vocale n'est pas supportÃ©e par ce navigateur.");
Â  Â  Â  Â  micButton.disabled = true;
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
Â  Â  Â  recognition = new SpeechRecognition();
Â  Â  Â  recognition.lang = 'fr-FR';
Â  Â  Â  recognition.interimResults = true; // On veut afficher le texte au fur et Ã  mesure
Â  Â  Â  recognition.continuous = true; // Pour Ã©couter en continu tant que tu parles

Â  Â  Â  recognition.onresult = (event) => {
Â  Â  Â  Â  let interimTranscript = '';
Â  Â  Â  Â  let finalTranscript = dreamInput.value; // texte dÃ©jÃ  dans le textarea

Â  Â  Â  Â  for (let i = event.resultIndex; i < event.results.length; ++i) {
Â  Â  Â  Â  Â  if (event.results[i].isFinal) {
Â  Â  Â  Â  Â  Â  finalTranscript += event.results[i][0].transcript + ' ';
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  interimTranscript += event.results[i][0].transcript;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  // Afficher le texte final + texte en cours
Â  Â  Â  Â  dreamInput.value = finalTranscript + interimTranscript;
Â  Â  Â  Â  // Garde le curseur Ã  la fin
Â  Â  Â  Â  dreamInput.selectionStart = dreamInput.selectionEnd = dreamInput.value.length;
Â  Â  Â  };

Â  Â  Â  recognition.onerror = (event) => {
Â  Â  Â  Â  if (event.error === 'not-allowed' || event.error === 'permission-denied') {
Â  Â  Â  Â  Â  alert("Permission microphone refusÃ©e. Active ton micro pour utiliser la dictÃ©e.");
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  console.error("Erreur reconnaissance vocale : ", event.error);
Â  Â  Â  Â  }
Â  Â  Â  };

Â  Â  Â  recognition.onend = () => {
Â  Â  Â  Â  // Si on Ã©tait en enregistrement, on remet le bouton en vert
Â  Â  Â  Â  if (isRecording) {
Â  Â  Â  Â  Â  toggleRecording(); // On relance la reconnaissance automatiquement (auto-restart)
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  }

Â  Â  function toggleRecording() {
Â  Â  Â  if (!recognition) return;
Â  Â  Â  if (isRecording) {
Â  Â  Â  Â  recognition.stop();
Â  Â  Â  Â  micButton.classList.remove('recording');
Â  Â  Â  Â  micButton.title = "DÃ©marrer la dictÃ©e vocale";
Â  Â  Â  Â  isRecording = false;
Â  Â  Â  } else {
Â  Â  Â  Â  recognition.start();
Â  Â  Â  Â  micButton.classList.add('recording');
Â  Â  Â  Â  micButton.title = "ArrÃªter la dictÃ©e vocale";
Â  Â  Â  Â  isRecording = true;
Â  Â  Â  }
Â  Â  }

Â  Â  micButton.addEventListener('click', toggleRecording);

Â  Â  // Effacer tout le texte
Â  Â  clearButton.addEventListener('click', () => {
Â  Â  Â  if (isRecording) toggleRecording(); // arrÃªter dictÃ©e si active
Â  Â  Â  dreamInput.value = '';
Â  Â  });

Â  Â  // Initialise reconnaissance vocale au chargement
Â  Â  setupRecognition();

Â  Â  // === Sauvegarde des rÃªves et gestion (inchangÃ©e) ===
Â  Â  function saveDream() {
Â  Â  Â  const text = dreamInput.value.trim();
Â  Â  Â  const isLucid = lucidCheckbox.checked;
Â  Â  Â  if (!text) return;
Â  Â  Â  const date = new Date().toLocaleString();
Â  Â  Â  const dreams = JSON.parse(localStorage.getItem("dreams") || "[]");
Â  Â  Â  dreams.unshift({ text, date, lucid: isLucid });
Â  Â  Â  localStorage.setItem("dreams", JSON.stringify(dreams));
Â  Â  Â  dreamInput.value = "";
Â  Â  Â  lucidCheckbox.checked = false;
Â  Â  Â  loadDreams();
Â  Â  }

Â  Â  function loadDreams() {
Â  Â  Â  const dreams = JSON.parse(localStorage.getItem("dreams") || "[]");
Â  Â  Â  const filter = filterSelect.value;
Â  Â  Â  dreamList.innerHTML = "";
Â  Â  Â  dreams.forEach((dream, index) => {
Â  Â  Â  Â  if (
Â  Â  Â  Â  Â  filter === "lucid" && !dream.lucid ||
Â  Â  Â  Â  Â  filter === "non-lucid" && dream.lucid
Â  Â  Â  Â  ) {
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  const li = document.createElement("li");
Â  Â  Â  Â  li.innerHTML = `
Â  Â  Â  Â  Â  <div>${dream.text}</div>
Â  Â  Â  Â  Â  <div class='date'>${dream.date}${dream.lucid ? " ğŸŒŸ RÃªve lucide" : ""}</div>
Â  Â  Â  Â  Â  <button class='delete-btn' onclick='deleteDream(${index})'>Supprimer</button>
Â  Â  Â  Â  `;
Â  Â  Â  Â  dreamList.appendChild(li);
Â  Â  Â  });
Â  Â  }

Â  Â  function deleteDream(index) {
Â  Â  Â  if (!confirm("Tu es sÃ»r de vouloir supprimer ce rÃªve ?")) return;
Â  Â  Â  const dreams = JSON.parse(localStorage.getItem("dreams") || "[]");
Â  Â  Â  dreams.splice(index, 1);
Â  Â  Â  localStorage.setItem("dreams", JSON.stringify(dreams));
Â  Â  Â  loadDreams();
Â  Â  }

Â  Â  function confirmDeleteAll() {
Â  Â  Â  if (!confirm("Supprimer TOUS les rÃªves ? Cette action est irrÃ©versible.")) return;
Â  Â  Â  localStorage.removeItem("dreams");
Â  Â  Â  loadDreams();
Â  Â  }

Â  Â  function exportDreams() {
Â  Â  Â  const dreams = JSON.parse(localStorage.getItem("dreams") || "[]");
Â  Â  Â  if (dreams.length === 0) {
Â  Â  Â  Â  alert("Aucun rÃªve Ã  exporter !");
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  let content = "Journal de RÃªves \n\n";
Â  Â  Â  dreams.forEach((dream, index) => {
Â  Â  Â  Â  content += `RÃªve #${dreams.length - index}\nDate : ${dream.date}${dream.lucid ? " (Lucide)" : ""}\n${dream.text}\n\n`;
Â  Â  Â  });
Â  Â  Â  const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
Â  Â  Â  const url = URL.createObjectURL(blob);
Â  Â  Â  const a = document.createElement("a");
Â  Â  Â  a.href = url;
Â  Â  Â  a.download = "journal_de_reves.txt";
Â  Â  Â  document.body.appendChild(a);
Â  Â  Â  a.click();
Â  Â  Â  document.body.removeChild(a);
Â  Â  Â  URL.revokeObjectURL(url);
Â  Â  }
Â  </script>
</body>
</html>
